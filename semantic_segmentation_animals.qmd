---
title: "Semantic image segmentation of cats and dogs"
format: html
editor: visual
---

# Semantic segmentation using images of cats and dogs

In this project, we'll be using semantic segmentation to isolate cats and dogs from their background images.

-   The dataset will be the [Oxford-IIIT Pets database](http://www.robots.ox.ac.uk/~vgg/ data/pets/), which contains over 7,390 images of different cats and dogs.

    -   Each of these images are paired with foreground-background segmentation masks

    -   The pixel of the segmentation masks will have one of three values:

        -   Foreground: 1

        -   Background: 2

        -   Contour: 3

## Packages

```{r}
library(fs)
library(keras3)

```

Wake up `reticulate`:

```{r}
op_add(1, 1)
```

## Data

First, we'll need to download and uncompressed the dataset using the `download.file()` and `untar()` utilities in R. We'll also use the `fs` package for filesystem operations.

```{r}
# Create directory
data_dir <- path("pets_dataset")
dir_create(data_dir)
```

```{r, eval = FALSE}
data_url <- path("https://thor.robots.ox.ac.uk/~vgg/data/pets")
for (filename in c("images.tar.gz", "annotations.tar.gz")) {
  download.file(url =  data_url / filename,
                destfile = data_dir / filename)
  untar(data_dir / filename, exdir = data_dir)
}

```
